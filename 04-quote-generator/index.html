<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Random Quote Generator</title>
    <style>
      /* ============================================
           CSS VARIABLES FOR THEMING
           Using :root to define reusable color values
           ============================================ */
      :root {
        --bg-color: #f0f4f8;
        --card-bg: #ffffff;
        --text-primary: #1a202c;
        --text-secondary: #4a5568;
        --accent-color: #4299e1;
        --accent-hover: #3182ce;
        --shadow: rgba(0, 0, 0, 0.1);
        --transition-speed: 0.3s;
      }

      /* ============================================
           DARK MODE SUPPORT
           Automatically switches based on system preference
           ============================================ */
      @media (prefers-color-scheme: dark) {
        :root {
          --bg-color: #1a202c;
          --card-bg: #2d3748;
          --text-primary: #f7fafc;
          --text-secondary: #e2e8f0;
          --accent-color: #63b3ed;
          --accent-hover: #4299e1;
          --shadow: rgba(0, 0, 0, 0.3);
        }
      }

      /* ============================================
           BASE STYLES & RESET
           ============================================ */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background-color: var(--bg-color);
        color: var(--text-primary);
        min-height: 100vh;
        /* Flexbox centering for the main container */
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        transition: background-color var(--transition-speed);
      }

      /* ============================================
           MAIN QUOTE CARD
           Using CSS Grid for internal layout
           ============================================ */
      .quote-container {
        background: var(--card-bg);
        border-radius: 20px;
        padding: 40px;
        max-width: 700px;
        width: 100%;
        box-shadow: 0 10px 40px var(--shadow);
        transition: all var(--transition-speed);
      }

      /* ============================================
           QUOTE CONTENT AREA
           Fade animation target
           ============================================ */
      .quote-content {
        min-height: 200px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        gap: 20px;
        /* Animation will be triggered via JS class toggle */
        opacity: 1;
        transition: opacity 0.4s ease-in-out;
      }

      /* Fade-out animation class */
      .quote-content.fade-out {
        opacity: 0;
      }

      /* Quote text styling with quotation marks */
      .quote-text {
        font-size: 1.5rem;
        line-height: 1.6;
        color: var(--text-primary);
        position: relative;
        padding: 0 20px;
      }

      /* Decorative quotation marks */
      .quote-text::before {
        content: '"';
        font-size: 4rem;
        color: var(--accent-color);
        position: absolute;
        left: -10px;
        top: -20px;
        opacity: 0.3;
      }

      /* Author attribution */
      .quote-author {
        font-size: 1.1rem;
        color: var(--text-secondary);
        text-align: right;
        font-style: italic;
      }

      .quote-author::before {
        content: "— ";
      }

      /* ============================================
           LOADING & ERROR STATES
           ============================================ */
      .loading,
      .error {
        text-align: center;
        padding: 40px;
        color: var(--text-secondary);
        font-size: 1.2rem;
      }

      .error {
        color: #e53e3e;
      }

      /* Loading spinner animation */
      .spinner {
        border: 3px solid var(--shadow);
        border-top: 3px solid var(--accent-color);
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 0 auto;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* ============================================
           BUTTON CONTROLS
           Using Flexbox for layout
           ============================================ */
      .controls {
        display: flex;
        gap: 12px;
        margin-top: 30px;
        flex-wrap: wrap;
      }

      /* Base button styles */
      button {
        flex: 1;
        min-width: 120px;
        padding: 14px 28px;
        font-size: 1rem;
        font-weight: 600;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.2s;
        color: white;
      }

      /* Primary button (New Quote) */
      .btn-primary {
        background: var(--accent-color);
      }

      .btn-primary:hover {
        background: var(--accent-hover);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px var(--shadow);
      }

      /* Secondary buttons */
      .btn-secondary {
        background: var(--text-secondary);
      }

      .btn-secondary:hover {
        background: var(--text-primary);
        transform: translateY(-2px);
      }

      /* Disabled state */
      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      /* ============================================
           ACCESSIBILITY FOCUS STYLES
           ============================================ */
      button:focus-visible {
        outline: 3px solid var(--accent-color);
        outline-offset: 2px;
      }

      /* ============================================
           RESPONSIVE DESIGN
           Mobile-friendly adjustments
           ============================================ */
      @media (max-width: 600px) {
        .quote-container {
          padding: 30px 20px;
        }

        .quote-text {
          font-size: 1.2rem;
        }

        .controls {
          flex-direction: column;
        }

        button {
          width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <!-- ============================================
         SEMANTIC HTML STRUCTURE
         Using semantic elements for accessibility
         ============================================ -->
    <main class="quote-container">
      <!-- Quote display area with ARIA live region for screen readers -->
      <div
        class="quote-content"
        id="quoteContent"
        role="region"
        aria-live="polite"
        aria-atomic="true"
      >
        <!-- Content will be dynamically inserted here -->
      </div>

      <!-- Control buttons with descriptive labels -->
      <div class="controls">
        <button
          class="btn-primary"
          id="newQuoteBtn"
          aria-label="Generate new random quote"
        >
          New Quote
        </button>
        <button
          class="btn-secondary"
          id="shareBtn"
          aria-label="Share this quote"
        >
          Share
        </button>
        <button
          class="btn-secondary"
          id="copyBtn"
          aria-label="Copy quote to clipboard"
        >
          Copy
        </button>
      </div>
    </main>

    <script>
      /* ============================================
           JAVASCRIPT - QUOTE GENERATOR LOGIC
           ============================================ */

      // DOM element references
      const quoteContent = document.getElementById("quoteContent");
      const newQuoteBtn = document.getElementById("newQuoteBtn");
      const shareBtn = document.getElementById("shareBtn");
      const copyBtn = document.getElementById("copyBtn");

      // State management
      let currentQuote = null;
      let quotesCache = []; // Store fetched quotes for offline fallback

      /* ============================================
           FALLBACK QUOTES
           Used if API fails or for offline functionality
           ============================================ */
      const fallbackQuotes = [
        {
          text: "The only way to do great work is to love what you do.",
          author: "Steve Jobs",
        },
        {
          text: "Innovation distinguishes between a leader and a follower.",
          author: "Steve Jobs",
        },
        {
          text: "Life is what happens when you're busy making other plans.",
          author: "John Lennon",
        },
        {
          text: "The future belongs to those who believe in the beauty of their dreams.",
          author: "Eleanor Roosevelt",
        },
        {
          text: "It is during our darkest moments that we must focus to see the light.",
          author: "Aristotle",
        },
        {
          text: "Be yourself; everyone else is already taken.",
          author: "Oscar Wilde",
        },
        {
          text: "The only impossible journey is the one you never begin.",
          author: "Tony Robbins",
        },
      ];

      /* ============================================
           FETCH QUOTES FROM API
           Using async/await for clean asynchronous code
           ============================================ */
      async function fetchQuote() {
        try {
          // Show loading state
          showLoading();

          // Fetch from public API (ZenQuotes API)
          const response = await fetch("https://zenquotes.io/api/random");

          // Check if response is successful
          if (!response.ok) {
            throw new Error("API request failed");
          }

          const data = await response.json();

          // Extract quote from API response
          const quote = {
            text: data[0].q,
            author: data[0].a,
          };

          // Cache the quote for offline use
          quotesCache.push(quote);

          return quote;
        } catch (error) {
          console.error("Error fetching quote:", error);

          // Fallback: use cached quotes or fallback array
          if (quotesCache.length > 0) {
            return quotesCache[Math.floor(Math.random() * quotesCache.length)];
          }

          return fallbackQuotes[
            Math.floor(Math.random() * fallbackQuotes.length)
          ];
        }
      }

      /* ============================================
           DISPLAY QUOTE WITH ANIMATION
           ============================================ */
      function displayQuote(quote) {
        // Store current quote globally
        currentQuote = quote;

        // Fade out animation
        quoteContent.classList.add("fade-out");

        // Wait for fade-out, then update content
        setTimeout(() => {
          quoteContent.innerHTML = `
                    <blockquote class="quote-text">${quote.text}</blockquote>
                    <p class="quote-author">${quote.author}</p>
                `;

          // Fade in animation
          quoteContent.classList.remove("fade-out");

          // Save to memory (not localStorage as per instructions)
          // This keeps the quote in memory during the session
        }, 400);
      }

      /* ============================================
           LOADING STATE UI
           ============================================ */
      function showLoading() {
        quoteContent.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p style="margin-top: 20px;">Loading wisdom...</p>
                </div>
            `;
      }

      /* ============================================
           ERROR STATE UI
           ============================================ */
      function showError(message) {
        quoteContent.innerHTML = `
                <div class="error">
                    <p>⚠️ ${message}</p>
                    <p style="margin-top: 10px; font-size: 0.9rem;">Using offline quotes instead.</p>
                </div>
            `;

        // Show a fallback quote after 1 second
        setTimeout(loadNewQuote, 1000);
      }

      /* ============================================
           LOAD NEW QUOTE
           Main function to fetch and display
           ============================================ */
      async function loadNewQuote() {
        try {
          // Disable button during loading
          newQuoteBtn.disabled = true;

          const quote = await fetchQuote();
          displayQuote(quote);
        } catch (error) {
          showError("Unable to fetch new quote");
        } finally {
          // Re-enable button
          newQuoteBtn.disabled = false;
        }
      }

      /* ============================================
           SHARE FUNCTIONALITY
           Using Web Share API with fallback
           ============================================ */
      async function shareQuote() {
        if (!currentQuote) return;

        const shareText = `"${currentQuote.text}" — ${currentQuote.author}`;

        // Check if Web Share API is supported
        if (navigator.share) {
          try {
            await navigator.share({
              title: "Inspiring Quote",
              text: shareText,
            });
          } catch (error) {
            // User cancelled or error occurred
            if (error.name !== "AbortError") {
              console.error("Error sharing:", error);
              copyToClipboard(); // Fallback to copy
            }
          }
        } else {
          // Fallback: copy to clipboard
          copyToClipboard();
          alert(
            "Quote copied to clipboard! (Share not supported on this browser)"
          );
        }
      }

      /* ============================================
           COPY TO CLIPBOARD
           Using modern Clipboard API
           ============================================ */
      async function copyToClipboard() {
        if (!currentQuote) return;

        const copyText = `"${currentQuote.text}" — ${currentQuote.author}`;

        try {
          // Modern Clipboard API
          await navigator.clipboard.writeText(copyText);

          // Visual feedback
          const originalText = copyBtn.textContent;
          copyBtn.textContent = "Copied!";

          setTimeout(() => {
            copyBtn.textContent = originalText;
          }, 2000);
        } catch (error) {
          console.error("Failed to copy:", error);
          alert("Failed to copy quote. Please try again.");
        }
      }

      /* ============================================
           EVENT LISTENERS
           ============================================ */
      newQuoteBtn.addEventListener("click", loadNewQuote);
      shareBtn.addEventListener("click", shareQuote);
      copyBtn.addEventListener("click", copyToClipboard);

      // Keyboard shortcut: Press 'N' for new quote
      document.addEventListener("keydown", (e) => {
        if (e.key === "n" || e.key === "N") {
          if (!newQuoteBtn.disabled) {
            loadNewQuote();
          }
        }
      });

      /* ============================================
           INITIALIZE APP
           Load first quote when page loads
           ============================================ */
      loadNewQuote();
    </script>
  </body>
</html>
